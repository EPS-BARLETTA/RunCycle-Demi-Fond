<!DOCTYPE html><html lang="fr"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>RunCycle ‚Äî Prof</title>
<style>
:root{--bg:#0b1020;--ink:#e6e9ef;--muted:#9aa4b2;--line:#222b3c;--panel:#0f172a;--primary:#3b82f6}
*{box-sizing:border-box}html,body{margin:0}
body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:radial-gradient(1200px 800px at 50% -10%,#13203e,#0b1020);color:var(--ink)}
header,footer{border-block:1px solid var(--line);padding:22px;text-align:center}
main{max-width:980px;margin:0 auto;padding:20px}
.card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));border:1px solid var(--line);border-radius:18px;padding:18px;margin:12px 0}
.grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
.btn{display:inline-flex;align-items:center;gap:10px;padding:12px 16px;border-radius:12px;border:1px solid var(--line);background:var(--panel);color:var(--ink);cursor:pointer;text-decoration:none;font-weight:600}
.btn.primary{background:var(--primary);color:white}
input,select,textarea{width:100%;padding:12px;border-radius:12px;border:1px solid var(--line);background:var(--panel);color:var(--ink);font-size:18px}
.preset{border:1px solid var(--line);border-radius:14px;padding:12px;background:var(--panel);cursor:pointer;margin:6px 0}
.banner{position:sticky;top:10px;display:flex;gap:12px;justify-content:space-between;align-items:center;padding:12px;border:1px solid #2c3951;border-radius:14px;background:var(--panel);font-weight:800}
.code{font:800 28px/1 ui-monospace,Menlo,Consolas,monospace}
.pill{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--line);border-radius:999px;padding:6px 10px;color:var(--muted);font-size:14px}
.overlay{position:fixed;inset:0;background:rgba(3,6,14,.96);display:grid;place-items:center;z-index:99}
.overlay>div{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:18px;max-width:360px;width:92%}
.warn{display:none;margin-top:8px;padding:10px;border:1px solid #9f1239;background:#2b0b14;color:#fecdd3;border-radius:12px}
</style>
<body>
<div id="gate" class="overlay" aria-hidden="true">
  <div>
    <h3>üîí Acc√®s Prof</h3>
    <p style="color:var(--muted)">Entrer le code (ou ajoutez <code>?p=57</code> / <code>#57</code> √† l‚ÄôURL).</p>
    <div style="display:flex;gap:8px">
      <input id="gateCode" type="password" inputmode="numeric" placeholder="Code" style="flex:1">
      <button class="btn primary" id="btnGate">Ouvrir</button>
    </div>
    <div id="err" style="display:none;color:#ef4444;margin-top:6px">Code incorrect</div>
    <script>
      (function(){
        function openGate(){
          var v=(document.getElementById('gateCode').value||'').trim();
          if(v==='57'){
            document.getElementById('gate').style.display='none';
            setTimeout(function(){ try{ applyPreset(); gen(); }catch(e){} }, 0);
          } else { document.getElementById('err').style.display='block'; }
        }
        document.getElementById('btnGate').addEventListener('click', openGate);
        document.getElementById('gateCode').addEventListener('keydown', function(ev){ if(ev.key==='Enter'){ openGate(); }});
        var u=location.search+location.hash;
        if(u.includes('p=57')||u.includes('#57')){
          document.getElementById('gate').style.display='none';
          setTimeout(function(){ try{ applyPreset(); gen(); }catch(e){} }, 0);
        }
      })();
    </script>
  </div>
</div>

<header><h1>RunCycle ‚Äî Prof</h1><div style="color:var(--muted)">S√©ances type / personnalis√©es ‚Ä¢ Code oral</div></header>
<main>
  <div class="banner">
    <div>CODE √âL√àVES : <span id="code" class="code">‚Äî</span></div>
    <div class="pill"><span id="sid">‚Äî</span></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button class="btn" id="btnCopy">Copier</button>
      <button class="btn" id="btnForce">Forcer g√©n√©ration</button>
    </div>
  </div>
  <div id="warn" class="warn"></div>

  <div class="card">
    <h2>‚≠ê S√©ances type</h2>
    <div class="grid">
      <div class="preset" data-k="S1"><b>S1 ‚Ä¢ Test 6‚Äô (VMA)</b><div style='color:var(--muted)'>1√ó6‚Äô ‚Äî estimation</div></div>
      <div class="preset" data-k="S2"><b>S2 ‚Ä¢ 2√ó6‚Äô @90%</b><div style='color:var(--muted)'>r=3‚Äô ‚Äî r√©gularit√©</div></div>
      <div class="preset" data-k="S3"><b>S3 ‚Ä¢ 3√ó4‚Äô 80/90/100%</b><div style='color:var(--muted)'>r=2‚Äô ‚Äî diff√©rencier</div></div>
      <div class="preset" data-k="S4"><b>S4 ‚Ä¢ 4√ó3‚Äô 90‚Üí95%</b><div style='color:var(--muted)'>r=2‚Äô ‚Äî projet</div></div>
      <div class="preset" data-k="S5"><b>S5 ‚Ä¢ √âval 4√ó3‚Äô @95%</b><div style='color:var(--muted)'>r=2‚Äô ‚Äî ¬±0,5 km/h</div></div>
    </div>
  </div>

  <div class="card">
    <h2>üóìÔ∏è Cr√©er / choisir</h2>
    <div class="grid">
      <div><label>S√©lection</label><select id="preset"><option value="S1">S1</option><option value="S2" selected>S2</option><option value="S3">S3</option><option value="S4">S4</option><option value="S5">S5</option></select></div>
      <div><label>Date</label><input id="sDate" type="date"></div>
      <div><label>Titre</label><input id="sTitre" placeholder="4√ó3‚Äô r=2‚Äô @95% VMA"></div>
      <div><label>Piste (m)</label><input id="sPiste" type="number" min="50" value="200"></div>
      <div><label>Blocs</label><input id="sBlocs" type="number" min="1" value="4"></div>
      <div><label>Dur√©e bloc (min)</label><input id="sDuree" type="number" min="1" value="3"></div>
      <div><label>R√©cup (min)</label><input id="sRecup" type="number" min="0" value="2"></div>
      <div><label>% VMA (liste)</label><input id="sPct" value="0.95"></div>
      <div style="grid-column:1/-1"><label>Consignes</label><textarea id="sNotes" rows="2" placeholder="R√©gularit√©, d√©part prudent, finish propre"></textarea></div>
    </div>
    <div style="margin-top:8px">
      <button class="btn" id="btnLoad">‚Ü∫ Charger s√©ance type</button>
      <button class="btn primary" id="btnGen">üîê G√©n√©rer / actualiser le code</button>
    </div>
    <div style="margin-top:8px"><label>Remplacer le code √©l√®ves (optionnel)</label><input id="manual" placeholder="ex: 202B"></div>
  </div>

  <div class="card" style="text-align:center"><a class="btn" href="./eleve.html">‚ñ∂Ô∏è Tester c√¥t√© √âl√®ve</a></div>
</main>
<footer>RunCycle ‚Äî √âquipe EPS Lyc√©e Vauban ‚Äî Luxembourg ‚Äî JB</footer>

<script>
const PRESETS={
 S1:{Titre:"Test 6' (estimation VMA)",Blocs:1,DureeBloc_min:6,Recup_min:0,Cible_%VMA:[]},
 S2:{Titre:"2√ó6' @ 90% VMA (r=3')",Blocs:2,DureeBloc_min:6,Recup_min:3,Cible_%VMA:[0.90,0.90]},
 S3:{Titre:"3√ó4' 80/90/100% (r=2')",Blocs:3,DureeBloc_min:4,Recup_min:2,Cible_%VMA:[0.80,0.90,1.00]},
 S4:{Titre:"4√ó3' 90‚Üí95% (r=2')",Blocs:4,DureeBloc_min:3,Recup_min:2,Cible_%VMA:[0.90,0.92,0.94,0.95]},
 S5:{Titre:"√âval 4√ó3' @95% (r=2')",Blocs:4,DureeBloc_min:3,Recup_min:2,Cible_%VMA:[0.95,0.95,0.95,0.95]}
};
const FIX = {S1:"101A",S2:"202B",S3:"303C",S4:"404D",S5:"505E"};
function warn(msg){ const w=document.getElementById('warn'); w.textContent=msg; w.style.display='block'; }
function clearWarn(){ const w=document.getElementById('warn'); w.style.display='none';}

function today(){return new Date().toISOString().slice(0,10)}
function applyPreset(){
  const p=PRESETS[document.getElementById('preset').value], D=document;
  D.getElementById('sDate').value=D.getElementById('sDate').value||today();
  D.getElementById('sTitre').value=p.Titre;
  D.getElementById('sBlocs').value=p.Blocs;
  D.getElementById('sDuree').value=p.DureeBloc_min;
  D.getElementById('sRecup').value=p.Recup_min;
  D.getElementById('sPct').value=p.Cible_%VMA.join(',');
}
function sameAsPreset(){
  const D=document, p=PRESETS[D.getElementById('preset').value];
  return D.getElementById('sTitre').value===p.Titre &&
         +D.getElementById('sBlocs').value===p.Blocs &&
         +D.getElementById('sDuree').value===p.DureeBloc_min &&
         +D.getElementById('sRecup').value===p.Recup_min &&
         (D.getElementById('sPct').value||'').replace(/\s+/g,'')===p.Cible_%VMA.join(',');
}
function build(){
  const D=document; return {
    Date:D.getElementById('sDate').value||today(),
    Titre:D.getElementById('sTitre').value||'S√©ance',
    Blocs:+D.getElementById('sBlocs').value||4,
    DureeBloc_min:+D.getElementById('sDuree').value||3,
    Recup_min:+D.getElementById('sRecup').value||2,
    Cible_%VMA:(D.getElementById('sPct').value||'0.95').split(',').map(x=>+x.trim()).filter(x=>!isNaN(x)),
    Piste_m:+D.getElementById('sPiste').value||200,
    Consignes:D.getElementById('sNotes').value||""
  };
}
function gen(){
  clearWarn();
  try{
    const s=build(); let code;
    const manual=(document.getElementById('manual').value||'').trim().toUpperCase();
    if(manual){ code=manual; }
    else if(sameAsPreset()){ code = FIX[document.getElementById('preset').value] || '000X'; }
    else { code = Math.random().toString(36).slice(2,10).toUpperCase(); localStorage.setItem('RC_custom_'+code, JSON.stringify(s)); }
    document.getElementById('code').textContent=code||'‚Äî';
    document.getElementById('sid').textContent = (s.Date + '_' + Math.random().toString(36).slice(2,6).toUpperCase());
    if(!code) warn("Le code n'a pas √©t√© g√©n√©r√©.");
  }catch(e){ warn("Erreur g√©n√©ration code: "+(e&&e.message?e.message:e)); }
}
function tile(k){ document.getElementById('preset').value=k; applyPreset(); gen(); }

document.addEventListener('DOMContentLoaded', function(){
  document.getElementById('btnLoad').addEventListener('click', function(){ applyPreset(); gen(); });
  document.getElementById('btnGen').addEventListener('click', gen);
  document.getElementById('btnCopy').addEventListener('click', function(){
    const c=document.getElementById('code').textContent||''; if(navigator.clipboard){ navigator.clipboard.writeText(c); }
  });
  document.getElementById('btnForce').addEventListener('click', gen);
  document.querySelectorAll('.preset').forEach(x=>x.addEventListener('click', function(){ tile(this.dataset.k); }));
  var u=location.search+location.hash;
  if(u.includes('p=57')||u.includes('#57')){ setTimeout(function(){ try{ applyPreset(); gen(); }catch(e){} }, 0); }
});
</script>
</body></html>
